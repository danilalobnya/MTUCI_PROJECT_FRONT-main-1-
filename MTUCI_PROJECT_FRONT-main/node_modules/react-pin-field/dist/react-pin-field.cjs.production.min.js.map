{"version":3,"file":"react-pin-field.cjs.production.min.js","sources":["../src/polyfills/keyboard-evt.ts","../src/utils/utils.ts","../src/pin-field/pin-field.tsx"],"sourcesContent":["/**\n * KeyboardEvent.key polyfill.\n *\n * @see https://github.com/soywod/keyboardevent-key-polyfill/blob/master/index.js\n */\n\nconst keyMap: {[key: number]: string | [string, string]} = {\n  3: \"Cancel\",\n  6: \"Help\",\n  8: \"Backspace\",\n  9: \"Tab\",\n  12: \"Clear\",\n  13: \"Enter\",\n  16: \"Shift\",\n  17: \"Control\",\n  18: \"Alt\",\n  19: \"Pause\",\n  20: \"CapsLock\",\n  27: \"Escape\",\n  28: \"Convert\",\n  29: \"NonConvert\",\n  30: \"Accept\",\n  31: \"ModeChange\",\n  32: \" \",\n  33: \"PageUp\",\n  34: \"PageDown\",\n  35: \"End\",\n  36: \"Home\",\n  37: \"ArrowLeft\",\n  38: \"ArrowUp\",\n  39: \"ArrowRight\",\n  40: \"ArrowDown\",\n  41: \"Select\",\n  42: \"Print\",\n  43: \"Execute\",\n  44: \"PrintScreen\",\n  45: \"Insert\",\n  46: \"Delete\",\n  48: [\"0\", \")\"],\n  49: [\"1\", \"!\"],\n  50: [\"2\", \"@\"],\n  51: [\"3\", \"#\"],\n  52: [\"4\", \"$\"],\n  53: [\"5\", \"%\"],\n  54: [\"6\", \"^\"],\n  55: [\"7\", \"&\"],\n  56: [\"8\", \"*\"],\n  57: [\"9\", \"(\"],\n  91: \"OS\",\n  93: \"ContextMenu\",\n  106: \"*\",\n  107: \"+\",\n  109: \"-\",\n  110: \".\",\n  111: \"/\",\n  144: \"NumLock\",\n  145: \"ScrollLock\",\n  181: \"VolumeMute\",\n  182: \"VolumeDown\",\n  183: \"VolumeUp\",\n  186: [\";\", \":\"],\n  187: [\"=\", \"+\"],\n  188: [\",\", \"<\"],\n  189: [\"-\", \"_\"],\n  190: [\".\", \">\"],\n  191: [\"/\", \"?\"],\n  192: [\"`\", \"~\"],\n  219: [\"[\", \"{\"],\n  220: [\"\\\\\", \"|\"],\n  221: [\"]\", \"}\"],\n  222: [\"'\", '\"'],\n  224: \"Meta\",\n  225: \"AltGraph\",\n  246: \"Attn\",\n  247: \"CrSel\",\n  248: \"ExSel\",\n  249: \"EraseEof\",\n  250: \"Play\",\n  251: \"ZoomOut\",\n};\n\n// Function keys (F1-24).\n\nlet i: number;\nfor (i = 1; i < 25; i += 1) {\n  keyMap[111 + i] = \"F\" + i;\n}\n\n// Printable ASCII characters.\n\nfor (i = 65; i < 91; i += 1) {\n  const letter = String.fromCharCode(i);\n  keyMap[i] = [letter.toLowerCase(), letter.toUpperCase()];\n}\n\n// Numbers on numeric keyboard.\n\nfor (i = 96; i < 106; i += 1) {\n  keyMap[i] = String.fromCharCode(i - 48);\n}\n\n/**\n * Find the key associated to a keyboard event.\n * Default to \"Unidentified\".\n */\nexport function getKeyFromKeyboardEvent(evt: KeyboardEvent): string {\n  if (evt.key && evt.key !== \"Unidentified\") {\n    return evt.key;\n  }\n\n  const key = keyMap[evt.which || evt.keyCode] || \"Unidentified\";\n\n  if (Array.isArray(key)) {\n    return key[+(evt.shiftKey || 0)];\n  }\n\n  return key;\n}\n\nexport default {\n  getKey: getKeyFromKeyboardEvent,\n};\n","export function noop(): void {\n  //\n}\n\nexport function range(start: number, length: number): number[] {\n  return Array.from({length}, (_, i) => i + start);\n}\n\nexport function omit<T extends Record<string, unknown>>(keys: string[], input: T): T {\n  let output: T = Object.create({});\n\n  for (let key in input) {\n    if (!keys.includes(key)) {\n      Object.assign(output, {[key]: input[key]});\n    }\n  }\n\n  return output;\n}\n","import React, {FC, forwardRef, useCallback, useImperativeHandle, useRef} from \"react\";\nimport {EffectReducer, StateReducer, useBireducer} from \"react-use-bireducer\";\n\nimport keyboardEventPolyfill from \"../polyfills/keyboard-evt\";\nimport {noop, range, omit} from \"../utils\";\n\nimport {\n  PinFieldDefaultProps as DefaultProps,\n  PinFieldInputProps as InputProps,\n  PinFieldProps as Props,\n  PinFieldNotifierProps as NotifierProps,\n  PinFieldState as State,\n  PinFieldAction as Action,\n  PinFieldEffect as Effect,\n} from \"./pin-field.types\";\n\nexport const NO_EFFECTS: Effect[] = [];\nexport const PROP_KEYS = [\"autoFocus\", \"length\", \"validate\", \"format\", \"formatAriaLabel\", \"debug\"];\nexport const HANDLER_KEYS = [\"onResolveKey\", \"onRejectKey\", \"onChange\", \"onComplete\"];\nexport const IGNORED_META_KEYS = [\"Alt\", \"Control\", \"Enter\", \"Meta\", \"Shift\", \"Tab\"];\n\nexport const defaultProps: DefaultProps = {\n  ref: {current: []},\n  length: 5,\n  validate: /^[a-zA-Z0-9]$/,\n  format: key => key,\n  formatAriaLabel: (idx: number, codeLength: number) => `pin code ${idx} of ${codeLength}`,\n  onResolveKey: noop,\n  onRejectKey: noop,\n  onChange: noop,\n  onComplete: noop,\n  debug: false,\n};\n\nexport function defaultState(props: Pick<DefaultProps, \"validate\" | \"length\">): State {\n  return {\n    focusIdx: 0,\n    codeLength: props.length,\n    isKeyAllowed: isKeyAllowed(props.validate),\n    fallback: null,\n  };\n}\n\nexport function getPrevFocusIdx(currFocusIdx: number) {\n  return Math.max(0, currFocusIdx - 1);\n}\n\nexport function getNextFocusIdx(currFocusIdx: number, lastFocusIdx: number) {\n  if (lastFocusIdx === 0) return 0;\n  return Math.min(currFocusIdx + 1, lastFocusIdx - 1);\n}\n\nexport function isKeyAllowed(predicate: DefaultProps[\"validate\"]) {\n  return (key: string) => {\n    if (!key) return false;\n    if (key.length > 1) return false;\n    if (typeof predicate === \"string\") return predicate.split(\"\").includes(key);\n    if (predicate instanceof Array) return predicate.includes(key);\n    if (predicate instanceof RegExp) return predicate.test(key);\n    return predicate(key);\n  };\n}\n\nexport function pasteReducer(state: State, idx: number, val: string): [State, Effect[]] {\n  const areAllKeysAllowed = val\n    .split(\"\")\n    .slice(0, state.codeLength)\n    .every(state.isKeyAllowed);\n\n  if (!areAllKeysAllowed) {\n    return [\n      state,\n      [\n        {type: \"set-input-val\", idx: state.focusIdx, val: \"\"},\n        {type: \"reject-key\", idx, key: val},\n        {type: \"handle-code-change\"},\n      ],\n    ];\n  }\n\n  const pasteLen = Math.min(val.length, state.codeLength - state.focusIdx);\n  const nextFocusIdx = getNextFocusIdx(pasteLen + state.focusIdx - 1, state.codeLength);\n  const effects: Effect[] = range(0, pasteLen).flatMap(idx => [\n    {\n      type: \"set-input-val\",\n      idx: idx + state.focusIdx,\n      val: val[idx],\n    },\n    {\n      type: \"resolve-key\",\n      idx: idx + state.focusIdx,\n      key: val[idx],\n    },\n  ]);\n\n  if (state.focusIdx !== nextFocusIdx) {\n    effects.push({type: \"focus-input\", idx: nextFocusIdx});\n  }\n\n  effects.push({type: \"handle-code-change\"});\n\n  return [{...state, focusIdx: nextFocusIdx}, effects];\n}\n\nexport const stateReducer: StateReducer<State, Action, Effect> = (state, action) => {\n  switch (action.type) {\n    case \"handle-key-down\": {\n      switch (action.key) {\n        case \"Unidentified\":\n        case \"Process\": {\n          return [{...state, fallback: {idx: state.focusIdx, val: action.val}}, NO_EFFECTS];\n        }\n\n        case \"Dead\": {\n          return [\n            state,\n            [\n              {type: \"set-input-val\", idx: state.focusIdx, val: \"\"},\n              {type: \"reject-key\", idx: state.focusIdx, key: action.key},\n              {type: \"handle-code-change\"},\n            ],\n          ];\n        }\n\n        case \"ArrowLeft\": {\n          const prevFocusIdx = getPrevFocusIdx(state.focusIdx);\n          return [{...state, focusIdx: prevFocusIdx}, [{type: \"focus-input\", idx: prevFocusIdx}]];\n        }\n\n        case \"ArrowRight\": {\n          const nextFocusIdx = getNextFocusIdx(state.focusIdx, state.codeLength);\n          return [{...state, focusIdx: nextFocusIdx}, [{type: \"focus-input\", idx: nextFocusIdx}]];\n        }\n\n        case \"Delete\":\n        case \"Backspace\": {\n          return [state, [{type: \"handle-delete\", idx: state.focusIdx}, {type: \"handle-code-change\"}]];\n        }\n\n        default: {\n          if (!state.isKeyAllowed(action.key)) {\n            return [state, [{type: \"reject-key\", idx: state.focusIdx, key: action.key}]];\n          }\n\n          const nextFocusIdx = getNextFocusIdx(state.focusIdx, state.codeLength);\n          return [\n            {...state, focusIdx: nextFocusIdx},\n            [\n              {type: \"set-input-val\", idx: state.focusIdx, val: action.key},\n              {type: \"resolve-key\", idx: state.focusIdx, key: action.key},\n              {type: \"focus-input\", idx: nextFocusIdx},\n              {type: \"handle-code-change\"},\n            ],\n          ];\n        }\n      }\n    }\n\n    case \"handle-key-up\": {\n      if (!state.fallback) {\n        return [state, NO_EFFECTS];\n      }\n\n      const nextState: State = {...state, fallback: null};\n      const effects: Effect[] = [];\n      const {idx, val: prevVal} = state.fallback;\n      const val = action.val;\n\n      if (prevVal === \"\" && val === \"\") {\n        effects.push({type: \"handle-delete\", idx}, {type: \"handle-code-change\"});\n      } else if (val !== \"\") {\n        return pasteReducer(nextState, idx, val);\n      }\n\n      return [nextState, effects];\n    }\n\n    case \"handle-paste\": {\n      return pasteReducer(state, action.idx, action.val);\n    }\n\n    case \"focus-input\": {\n      return [{...state, focusIdx: action.idx}, [{type: \"focus-input\", idx: action.idx}]];\n    }\n\n    default: {\n      return [state, NO_EFFECTS];\n    }\n  }\n};\n\nexport function useEffectReducer({refs, ...props}: NotifierProps): EffectReducer<Effect, Action> {\n  return useCallback(\n    effect => {\n      switch (effect.type) {\n        case \"focus-input\": {\n          refs.current[effect.idx].focus();\n          break;\n        }\n\n        case \"set-input-val\": {\n          const val = props.format(effect.val);\n          refs.current[effect.idx].value = val;\n          break;\n        }\n\n        case \"resolve-key\": {\n          refs.current[effect.idx].setCustomValidity(\"\");\n          props.onResolveKey(effect.key, refs.current[effect.idx]);\n          break;\n        }\n\n        case \"reject-key\": {\n          refs.current[effect.idx].setCustomValidity(\"Invalid key\");\n          props.onRejectKey(effect.key, refs.current[effect.idx]);\n          break;\n        }\n\n        case \"handle-delete\": {\n          const prevVal = refs.current[effect.idx].value;\n          refs.current[effect.idx].setCustomValidity(\"\");\n          refs.current[effect.idx].value = \"\";\n\n          if (!prevVal) {\n            const prevIdx = getPrevFocusIdx(effect.idx);\n            refs.current[prevIdx].focus();\n            refs.current[prevIdx].setCustomValidity(\"\");\n            refs.current[prevIdx].value = \"\";\n          }\n\n          break;\n        }\n\n        case \"handle-code-change\": {\n          const dir = (props.dir || document.documentElement.getAttribute(\"dir\") || \"ltr\").toLowerCase();\n          const codeArr = refs.current.map(r => r.value.trim());\n          const code = (dir === \"rtl\" ? codeArr.reverse() : codeArr).join(\"\");\n          props.onChange(code);\n          code.length === props.length && props.onComplete(code);\n          break;\n        }\n\n        default: {\n          break;\n        }\n      }\n    },\n    [props, refs],\n  );\n}\n\nexport const PinField: FC<Props> = forwardRef((customProps, fwdRef) => {\n  const props: DefaultProps & InputProps = {...defaultProps, ...customProps};\n  const {autoFocus, formatAriaLabel, length: codeLength} = props;\n  const inputProps: InputProps = omit([...PROP_KEYS, ...HANDLER_KEYS], props);\n  const refs = useRef<HTMLInputElement[]>([]);\n  const effectReducer = useEffectReducer({refs, ...props});\n  const dispatch = useBireducer(stateReducer, effectReducer, defaultState(props))[1];\n\n  useImperativeHandle(fwdRef, () => refs.current, [refs]);\n\n  function handleFocus(idx: number) {\n    return function() {\n      dispatch({type: \"focus-input\", idx});\n    };\n  }\n\n  function handleKeyDown(idx: number) {\n    return function(evt: React.KeyboardEvent<HTMLInputElement>) {\n      const key = keyboardEventPolyfill.getKey(evt.nativeEvent);\n      if (\n        !IGNORED_META_KEYS.includes(key) &&\n        !evt.ctrlKey &&\n        !evt.altKey &&\n        !evt.metaKey &&\n        evt.nativeEvent.target instanceof HTMLInputElement\n      ) {\n        evt.preventDefault();\n        dispatch({type: \"handle-key-down\", idx, key, val: evt.nativeEvent.target.value});\n      }\n    };\n  }\n\n  function handleKeyUp(idx: number) {\n    return function(evt: React.KeyboardEvent<HTMLInputElement>) {\n      if (evt.nativeEvent.target instanceof HTMLInputElement) {\n        dispatch({type: \"handle-key-up\", idx, val: evt.nativeEvent.target.value});\n      }\n    };\n  }\n\n  function handlePaste(idx: number) {\n    return function(evt: React.ClipboardEvent<HTMLInputElement>) {\n      evt.preventDefault();\n      const val = evt.clipboardData.getData(\"Text\");\n      dispatch({type: \"handle-paste\", idx, val});\n    };\n  }\n\n  function setRefAtIndex(idx: number) {\n    return function(ref: HTMLInputElement) {\n      if (ref) {\n        refs.current[idx] = ref;\n      }\n    };\n  }\n\n  function hasAutoFocus(idx: number) {\n    return Boolean(idx === 0 && autoFocus);\n  }\n\n  return (\n    <>\n      {range(0, codeLength).map(idx => (\n        <input\n          type=\"text\"\n          autoCapitalize=\"off\"\n          autoCorrect=\"off\"\n          autoComplete=\"off\"\n          inputMode=\"text\"\n          {...inputProps}\n          aria-disabled={inputProps.disabled ? \"true\" : undefined}\n          aria-label={formatAriaLabel(idx + 1, codeLength)}\n          aria-readonly={inputProps.readOnly ? \"true\" : undefined}\n          aria-required=\"true\"\n          key={idx}\n          ref={setRefAtIndex(idx)}\n          autoFocus={hasAutoFocus(idx)}\n          onFocus={handleFocus(idx)}\n          onKeyDown={handleKeyDown(idx)}\n          onKeyUp={handleKeyUp(idx)}\n          onPaste={handlePaste(idx)}\n        />\n      ))}\n    </>\n  );\n});\n\nexport default PinField;\n"],"names":["i","keyMap","3","6","8","9","12","13","16","17","18","19","20","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","48","49","50","51","52","53","54","55","56","57","91","93","106","107","109","110","111","144","145","181","182","183","186","187","188","189","190","191","192","219","220","221","222","224","225","246","247","248","249","250","251","letter","String","fromCharCode","toLowerCase","toUpperCase","noop","range","start","length","Array","from","_","NO_EFFECTS","PROP_KEYS","HANDLER_KEYS","IGNORED_META_KEYS","defaultProps","ref","current","validate","format","key","formatAriaLabel","idx","codeLength","onResolveKey","onRejectKey","onChange","onComplete","debug","defaultState","props","focusIdx","isKeyAllowed","fallback","getPrevFocusIdx","currFocusIdx","Math","max","getNextFocusIdx","lastFocusIdx","min","predicate","split","includes","RegExp","test","pasteReducer","state","val","slice","every","type","pasteLen","nextFocusIdx","effects","flatMap","push","stateReducer","action","prevFocusIdx","nextState","useEffectReducer","refs","useCallback","effect","focus","value","setCustomValidity","prevVal","prevIdx","dir","document","documentElement","getAttribute","codeArr","map","r","trim","code","reverse","join","PinField","forwardRef","customProps","fwdRef","autoFocus","inputProps","keys","input","output","Object","create","assign","omit","useRef","effectReducer","dispatch","useBireducer","handleFocus","handleKeyDown","evt","which","keyCode","isArray","shiftKey","keyboardEventPolyfill","nativeEvent","ctrlKey","altKey","metaKey","target","HTMLInputElement","preventDefault","handleKeyUp","handlePaste","clipboardData","getData","setRefAtIndex","hasAutoFocus","Boolean","useImperativeHandle","React","autoCapitalize","autoCorrect","autoComplete","inputMode","disabled","undefined","readOnly","onFocus","onKeyDown","onKeyUp","onPaste"],"mappings":"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"}