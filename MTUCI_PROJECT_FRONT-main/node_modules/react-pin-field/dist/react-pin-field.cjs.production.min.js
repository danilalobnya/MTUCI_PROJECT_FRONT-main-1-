"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=require("react"),r=(e=t)&&"object"==typeof e&&"default"in e?e.default:e,n=require("react-use-bireducer");function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var o,u={3:"Cancel",6:"Help",8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",28:"Convert",29:"NonConvert",30:"Accept",31:"ModeChange",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",41:"Select",42:"Print",43:"Execute",44:"PrintScreen",45:"Insert",46:"Delete",48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],91:"OS",93:"ContextMenu",106:"*",107:"+",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",181:"VolumeMute",182:"VolumeDown",183:"VolumeUp",186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"'],224:"Meta",225:"AltGraph",246:"Attn",247:"CrSel",248:"ExSel",249:"EraseEof",250:"Play",251:"ZoomOut"};for(o=1;o<25;o+=1)u[111+o]="F"+o;for(o=65;o<91;o+=1){var c=String.fromCharCode(o);u[o]=[c.toLowerCase(),c.toUpperCase()]}for(o=96;o<106;o+=1)u[o]=String.fromCharCode(o-48);function i(){}function l(e,t){return Array.from({length:t},(function(t,r){return r+e}))}var s=["refs"],d=[],f=["autoFocus","length","validate","format","formatAriaLabel","debug"],p=["onResolveKey","onRejectKey","onChange","onComplete"],y=["Alt","Control","Enter","Meta","Shift","Tab"],x={ref:{current:[]},length:5,validate:/^[a-zA-Z0-9]$/,format:function(e){return e},formatAriaLabel:function(e,t){return"pin code "+e+" of "+t},onResolveKey:i,onRejectKey:i,onChange:i,onComplete:i,debug:!1};function v(e){return{focusIdx:0,codeLength:e.length,isKeyAllowed:k(e.validate),fallback:null}}function h(e){return Math.max(0,e-1)}function g(e,t){return 0===t?0:Math.min(e+1,t-1)}function k(e){return function(t){return!!t&&!(t.length>1)&&("string"==typeof e?e.split("").includes(t):e instanceof Array?e.includes(t):e instanceof RegExp?e.test(t):e(t))}}function m(e,t,r){if(!r.split("").slice(0,e.codeLength).every(e.isKeyAllowed))return[e,[{type:"set-input-val",idx:e.focusIdx,val:""},{type:"reject-key",idx:t,key:r},{type:"handle-code-change"}]];var n=Math.min(r.length,e.codeLength-e.focusIdx),o=g(n+e.focusIdx-1,e.codeLength),u=l(0,n).flatMap((function(t){return[{type:"set-input-val",idx:t+e.focusIdx,val:r[t]},{type:"resolve-key",idx:t+e.focusIdx,key:r[t]}]}));return e.focusIdx!==o&&u.push({type:"focus-input",idx:o}),u.push({type:"handle-code-change"}),[a({},e,{focusIdx:o}),u]}var b=function(e,t){switch(t.type){case"handle-key-down":switch(t.key){case"Unidentified":case"Process":return[a({},e,{fallback:{idx:e.focusIdx,val:t.val}}),d];case"Dead":return[e,[{type:"set-input-val",idx:e.focusIdx,val:""},{type:"reject-key",idx:e.focusIdx,key:t.key},{type:"handle-code-change"}]];case"ArrowLeft":var r=h(e.focusIdx);return[a({},e,{focusIdx:r}),[{type:"focus-input",idx:r}]];case"ArrowRight":var n=g(e.focusIdx,e.codeLength);return[a({},e,{focusIdx:n}),[{type:"focus-input",idx:n}]];case"Delete":case"Backspace":return[e,[{type:"handle-delete",idx:e.focusIdx},{type:"handle-code-change"}]];default:if(!e.isKeyAllowed(t.key))return[e,[{type:"reject-key",idx:e.focusIdx,key:t.key}]];var o=g(e.focusIdx,e.codeLength);return[a({},e,{focusIdx:o}),[{type:"set-input-val",idx:e.focusIdx,val:t.key},{type:"resolve-key",idx:e.focusIdx,key:t.key},{type:"focus-input",idx:o},{type:"handle-code-change"}]]}case"handle-key-up":if(!e.fallback)return[e,d];var u=a({},e,{fallback:null}),c=[],i=e.fallback,l=i.idx,s=t.val;if(""===i.val&&""===s)c.push({type:"handle-delete",idx:l},{type:"handle-code-change"});else if(""!==s)return m(u,l,s);return[u,c];case"handle-paste":return m(e,t.idx,t.val);case"focus-input":return[a({},e,{focusIdx:t.idx}),[{type:"focus-input",idx:t.idx}]];default:return[e,d]}};function C(e){var r=e.refs,n=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)t.indexOf(r=o[n])>=0||(a[r]=e[r]);return a}(e,s);return t.useCallback((function(e){switch(e.type){case"focus-input":r.current[e.idx].focus();break;case"set-input-val":var t=n.format(e.val);r.current[e.idx].value=t;break;case"resolve-key":r.current[e.idx].setCustomValidity(""),n.onResolveKey(e.key,r.current[e.idx]);break;case"reject-key":r.current[e.idx].setCustomValidity("Invalid key"),n.onRejectKey(e.key,r.current[e.idx]);break;case"handle-delete":var a=r.current[e.idx].value;if(r.current[e.idx].setCustomValidity(""),r.current[e.idx].value="",!a){var o=h(e.idx);r.current[o].focus(),r.current[o].setCustomValidity(""),r.current[o].value=""}break;case"handle-code-change":var u=(n.dir||document.documentElement.getAttribute("dir")||"ltr").toLowerCase(),c=r.current.map((function(e){return e.value.trim()})),i=("rtl"===u?c.reverse():c).join("");n.onChange(i),i.length===n.length&&n.onComplete(i)}}),[n,r])}var I=t.forwardRef((function(e,o){var c=a({},x,e),i=c.autoFocus,s=c.formatAriaLabel,d=c.length,h=function(e,t){var r=Object.create({});for(var n in t){var a;e.includes(n)||Object.assign(r,((a={})[n]=t[n],a))}return r}([].concat(f,p),c),g=t.useRef([]),k=C(a({refs:g},c)),m=n.useBireducer(b,k,v(c))[1];function I(e){return function(){m({type:"focus-input",idx:e})}}function E(e){return function(t){var r=function(e){if(e.key&&"Unidentified"!==e.key)return e.key;var t=u[e.which||e.keyCode]||"Unidentified";return Array.isArray(t)?t[+(e.shiftKey||0)]:t}(t.nativeEvent);y.includes(r)||t.ctrlKey||t.altKey||t.metaKey||!(t.nativeEvent.target instanceof HTMLInputElement)||(t.preventDefault(),m({type:"handle-key-down",idx:e,key:r,val:t.nativeEvent.target.value}))}}function A(e){return function(t){t.nativeEvent.target instanceof HTMLInputElement&&m({type:"handle-key-up",idx:e,val:t.nativeEvent.target.value})}}function w(e){return function(t){t.preventDefault();var r=t.clipboardData.getData("Text");m({type:"handle-paste",idx:e,val:r})}}function K(e){return function(t){t&&(g.current[e]=t)}}function L(e){return Boolean(0===e&&i)}return t.useImperativeHandle(o,(function(){return g.current}),[g]),r.createElement(r.Fragment,null,l(0,d).map((function(e){return r.createElement("input",Object.assign({type:"text",autoCapitalize:"off",autoCorrect:"off",autoComplete:"off",inputMode:"text"},h,{"aria-disabled":h.disabled?"true":void 0,"aria-label":s(e+1,d),"aria-readonly":h.readOnly?"true":void 0,"aria-required":"true",key:e,ref:K(e),autoFocus:L(e),onFocus:I(e),onKeyDown:E(e),onKeyUp:A(e),onPaste:w(e)}))})))}));exports.HANDLER_KEYS=p,exports.IGNORED_META_KEYS=y,exports.NO_EFFECTS=d,exports.PROP_KEYS=f,exports.PinField=I,exports.default=I,exports.defaultProps=x,exports.defaultState=v,exports.getNextFocusIdx=g,exports.getPrevFocusIdx=h,exports.isKeyAllowed=k,exports.pasteReducer=m,exports.stateReducer=b,exports.useEffectReducer=C;
//# sourceMappingURL=react-pin-field.cjs.production.min.js.map
